-- Tạo cơ sở dữ liệu hechuyengia
CREATE DATABASE hechuyengia;

-- Sử dụng cơ sở dữ liệu hechuyengia
-- USE hechuyengia;
USE hcg_cdb;
-- Tạo bảng Benh
CREATE TABLE benh (
   ma_benh INT PRIMARY KEY,
    ten_benh NVARCHAR(255)
);

-- Tạo bảng TrieuChung
CREATE TABLE trieu_chung (
	ma_trieu_chung NVARCHAR(255),
    ten_trieu_chung INT PRIMARY KEY
    
);

-- Tạo bảng Moi Quan He Nhieu-Nhieu giua Trieu Chung va Benh
CREATE TABLE trieu_chung_benh (
	ma_benh INT,
    ma_trieu_chung INT,
    PRIMARY KEY (ma_trieu_chung, ma_benh),
    FOREIGN KEY (ma_trieu_chung) REFERENCES trieu_chung(ma_trieu_chung),
    FOREIGN KEY (ma_benh) REFERENCES Benh(ma_benh)
);

-- Tạo bảng Luat
CREATE TABLE Luat (
    ma_luat INT PRIMARY KEY,
    ten_luat NVARCHAR(255),
    loai_luat INT
);

-- Tạo bảng liên kết giữa triệu chứng và luật
CREATE TABLE lien_ket_trieu_chung_luat (
   ma_luat INT,
    ma_trieu_chung INT,
    PRIMARY KEY (ma_luat, ma_trieu_chung),
    FOREIGN KEY (ma_luat) REFERENCES Luat(ma_luat),
    FOREIGN KEY (ma_trieu_chung) REFERENCES trieu_chung(ma_trieu_chung)
);

-- Tạo bảng liên kết giữa bệnh và luật
CREATE TABLE lien_ket_benh_luat (
    ma_luat INT,
    ma_benh INT,
    PRIMARY KEY (ma_luat, ma_benh),
    FOREIGN KEY (ma_luat) REFERENCES Luat(ma_luat),
    FOREIGN KEY (ma_benh) REFERENCES Benh(ma_benh)
);
delete from benh;
delete from trieu_chung;
delete from trieu_chung_benh;

INSERT INTO trieu_chung (ma_trieu_chung, ten_trieu_chung)
VALUES
    (1, N'Khó thở nhẹ'), -- 27
    (2, N'Khó thở nặng khi gắng sức'),
    (3, N'Ho theo cơn'),
    (4, N'Ho ra máu'),
    (5, N'Thở Khò khè'   ), -- 27
    (6, N'Ho'   ),
    (7, N'Đau người'   ),
    (8, N'Viêm mũi'   ),
    (9, N'Nghẹt mũi'   ), -- 27
    (10, N'Tiết đờm'   ),
    (11, N'Đau rát họng'   ),
    (12, N'Mệt mỏi'   ),
    (13, N'Thở nhanh'   ), -- 27
    (14, N'Ngứa họng sâu'   ),
    (15, N'Lượng đờm tiết ra hoặc cường độ ho sẽ khác nhau'   ),
    (16, N'Biến dạng lồng ngực'   ),
    (17, N'Khó thở'   ), -- 27
    (18, N'Sốt 37-38 độ'   ),
    (19, N'Ho kéo dài'   ),
    (20, N'Chảy nước mũi'), -- 27
    (21, N'Rút lõm lồng ngực khi thở.'   ),
    (22, N'Trẻ có thể bỏ bú.'   ),
    (23, N'Da Tím tái khi nặng hơn.'   ),
    (24, N'Ngủ ngáy'   ),
    (25, N'Tức ngực'   ),-- 27
    (26, N'Chán ăn'   ),
    (27, N'Gầy sút'   ),
    (28, N'Cảm giác đau vùng thượng vị (vùng trên ngực).'   ),
    (29, N'Ho có đờm'   ), -- 27
    (30, N'Sốt trên 38 độ C'   ),
    (31, N'Đau tức ngực'   ),
    (32, N'Ớn lạnh'   ),
    (33, N'Ho khan'   ),
    (34, N'Đau cơ'   ),
    (35, N'Yếu người'   ),
    (36, N'Đau đầu'   ),-- 27
    (37, N'Nhiễm trùng ngực thường xuyên'   ),
    (38, N'Đau ngực'   ),
    (39, N'Khàn tiếng'   ),
    (40, N'Rét run'   ),
    (41, N'Sưng mặt hoặc Cổ'   ),
    (42, N'Ớn lạnh'   ),
    (43, N'Cảm lạnh'   ),
    (44, N'Da tái xanh'   ),
    (45, N'Đau cứng cơ'   ), -- 27 
    (46, N'Choáng váng'   ),
    (47, N'Nhịp tim nhanh'   ),
    (48, N'Mất ý thức'   ),
    (49, N'Nôn ói'   ),
    (50, N'Huyết áp thấp'   ),
    (51, N'Vã mồ hôi'   ),
    (52, N'Khó thở và phải ngồi'   ),
    (53, N'Các chi lạnh'   ),
    (54, N'Cảm giác ngộp thở'   ),
    (55, N'Phần tĩnh mạch cổ của người bệnh nổi ở tư thế nằm đầu cao 45 độ.'   ),
    (56, N'nổi mụn nước ở quanh miệng, môi,niêm mạc họng...'   ),
    (57, N'Sụt cân không rõ nguyên nhân.'   ),
    (58, N'Phù chân'   ),
    (59, N'Xanh tím ở da, niêm mạc mũi, miệng'   ),
    (60,N'Giảm Cân'),
    (61,N'Đau xương'),
    (62, N'Phát ban'   ),
    (63, N'Khó thở khi thở ra và cần phải ngồi dậy để thở.'   ),
    (64, N'Thở rít'   ),
    (65, N'Khạc đờm đen'   ),
    (66, N'Bị viêm tắc nghẽn tiểu phế quản'   ),
    (67, N'Sưng hạch hầu, có mảng trắng trong cổ họng hoặc chấm đỏ trên vòm miệng'   ),
    (68, N'Hạch bạch huyết ở cổ sưng đau'   ),
    (69, N'Chưa tiêm ngừa vi khuẩn bạch hầu'   ),
    (70, N'Bệnh khởi đầu sốt, vướng họng và ho'   ),
    (71, N'Mọc giả mạc vùng amidan, vùng họng, giả mạc màu trắng xám, dai, dễ chảy máu'   ),
    (72, N'Sưng hạch dưới hàm, hạch vùng cổ'   ),
    (73, N'Ngứa mũi'   ),
    (74, N'Khô họng'   ),
    (75, N'Phù nề thanh quản'   ),
    (76, N'Tiết nhiều nước bọt'   ),
    (77, N'Khạc ra mủ, máu'   ),
    (78, N'Ù tai'   ),
    (79, N'Nổi hạch'   ),
    (80, N'Niêm mạc mũi sưng'   ),
    (81, N'Khứu giác kém'   ),
    (82, N'Đau vùng xoang'   ),
    (83, N'Tái xoang nhiều lần'   ),
    (84, N'Mất khứu giác'   ),
    (85, N'Thay đổi hình dạng khuôn mặt'   ),
    (86, N'Sưng mắt'   ),
    (87, N'Đau răng hàm trên'   ),
    (88, N'Đau nặng tai'   ),
	(89, N'Nuốt khó'   ),
	(90, N'Nói khó'   ),
	(91, N'Nổi 1 hay nhiều hạch ở góc hàm, dưới cằm, hai bên cổ, hạch sưng to đau khi sờ nắn'   ),
	(92, N'Buồn nôn'   ),
	(93, N'Hắt hơi'   ),
	(94, N'Bệnh nhiều ở ngày thứ hai hoặc 3,sổ mũi kéo dài đến hơn 1 tuần'   ),
	(95, N'Viêm kết mạc'   ),
	(96, N'Nước mũi trong sau đục và Niêm mạc mũi bóng'   ),
	(97, N'Chảy máu mũi'   ),
	(98, N'Đau nhức vùng mặt đầu'   );

	

-- Đưa dữ liệu vào bảng Benh
INSERT INTO Benh (ma_benh, ten_benh,loai_he)
VALUES
	
	(1, N'Viêm họng cấp do siêu vi',N'1'),
    (2, N'Viêm họng do liên cầu khuẩn',N'1'),
    (3, N'Bạch hầu họng và amidan',N'1'),
    (4, N'Viêm họng dị ứng',N'1'),
    (5, N'Ung thư vòm họng',N'1'),
    (6, N'Viêm Mũi dị ứng',N'1'),
    (7, N'Viêm mũi cấp',N'1'),
    (8, N'Viêm mũi mãn tính',N'1'),
    (9, N'Viêm xoang cấp tính',N'1'),
    (10, N'Viêm xoang mãn tính',N'1'),
    (11, N'Polyp mũi xoang' ,N'1'),
    (12, N'Ung thư mũi' ,N'1'),
    (13, N'Viêm thanh quản',N'1' ),
    (14, N'Ung thư thanh quản' ,N'1' ),
    (15, N'Lao thanh quản',N'1' ),
    (16, N'Polyp thanh quản' ,N'1'),
    (17, N'Nang dây thanh' ,N'1'),
    (18, N'Hẹp khí quản',N'2' ),
     (19, N'Không có bệnh',N'2' ),
    (20, N'U khí quản',N'2' ),
    (21, N'Viêm phế quản cấp tính',N'2' ),
    (22, N'Viêm phế quản mãn tính' ,N'2' ),
    (23, N'Viêm tiểu phế quản',N'2' ),
    (24, N'Giãn phế nang' ,N'2' ),
    (25, N'Viêm phổi do vi khuẩn' ,N'2' ),
    (26, N'Viêm phổi do virus' ,N'2'),
    (27, N'Nhiễm trùng đường hô hấp',N'2'),
    (28, N'Bệnh phổi tắc nghẽn mạn tính (COPD)' ,N'2'),
    (29, N'Ung thư phổi',N'2' ),
    (30, N'Viêm màng phổi' ,N'2'),
    (31, N'Thuyên tắc phổi',N'2' ),
    (32, N'Phù phổi',N'2' ),
    (33, N'Xơ phổi',N'2' ),
    (34, N'Tăng áp động mạch phổi' ,N'2' ),
    (35, N'Hội chứng suy hô hấp',N'2' ),
    (36, N'Hen phế quản',N'2' ),
    (37, N'Bụi phổi' ,N'2' );

-- thêm dl vào bảng BenhTrieu Trung
INSERT INTO trieu_chung_benh (ma_benh, ma_trieu_chung)
VALUES
	(1, 30),
    (1, 11),
	(1, 3),
	(1, 90),
	(1, 91),
	(1, 56),
	(1, 92),
	(1, 7),
	(1, 12),
	(1, 36),
	(1, 26),
	-- --2
    (2, 30),
    (2, 36),
	(2, 62),
	(2, 26),
	(2, 93),
	(2, 45),
	(2, 67),
	(2, 68),
	-- 3 
	(3, 69),
	(3, 70),
	(3, 71),
	(3, 72),
	-- 4
	(4, 24),
	(4, 17),
	(4, 73),
	(4, 20),
	(4, 74),
	(4, 90),
	(4, 6),
	(4, 5),
	(4, 39),
	(4, 91),
	(4, 76),
	-- 5 
	(5, 11),
	(5, 9),
	(5, 29),
	(5, 36),
	(5, 78),
	(5, 79),
	-- 6 
	(6, 24),
	(6, 17),
	(6, 73),
	(6, 20),
	(6, 74),
	(6, 11),
	(6, 6),
	(6, 5),
	-- 7 
	(7, 9),
	(7, 20),
	(7, 94),
	(7, 11),
	(7, 14),
	(7, 6),
	(7, 30),
	(7, 95),
	(7, 96),
	(7, 97),
	-- 8
	(8, 9),
	(8, 20),
	(8, 81),
	(8, 80),
	-- 9
	(9, 82),
	(9, 92),
	(9, 9),
	-- 10
	(10, 84),
	(10, 9),
	(10, 83),

	-- 11
	(11, 17),
	(11, 85),
	(11, 81),
	-- 12
	(12, 82),
	(12, 97),
	(12, 98),
	(12, 87),
	(12, 88),
	(12, 89),
	-- 13
	(13, 75),
	(13, 11),
	(13, 76),
	(13, 17),
	(13, 39),
	-- 14
	(14, 19),
	(14, 39),
	(14, 17),
	(14, 57),
	-- 15
	(15, 11),
	(15, 6),
	(15, 17),
	(15, 77),
	-- 16
	(16, 39),
	(16, 12),
	(16, 11),
	(16, 17),
	-- 17
	(17, 39),
	(17, 90),
	(17, 17),
	-- 18
	(18, 1),
	(18, 2),
	(18, 3),
    (18, 59),

	-- 20
	(20, 1),
	(20, 4),
	(20, 5),
	-- 21
	(21, 6),
	(21, 18),
	(21, 8),
	(21,9),
	(21, 5),
	(21, 12),
	(21, 13),
	(21, 14),
	-- 22
	(22, 19),
	(22, 15),
	(22, 5),
	(22, 17),
	(22, 18),
	-- 23
	(23, 19),
	(23, 18),
	(23, 20),
	(23, 5),
	(22, 21),
	(22, 22),
	(22, 23),
	(22, 13),
	-- 24
	(24, 17),
	(24, 25),
	(24, 19),
	(24, 26),
	(24, 27),
	(24, 12),
	(24, 28),
	-- 25
	(25, 29),
	(25, 30),
	(25, 13),
	(25, 17),
	(25, 31),
	(25, 12),
	-- 26
	(26, 18),
	(26, 32),
	(26,40),
	(26, 33),
	(26, 20),
	(26, 34),
	(26, 36),
	(26, 35),
	(26, 12),
	-- 27 
    (27, 1),
	(27, 5),
	(27, 9),
	(27, 13),
	(27, 17),
	(27, 20),
	(27, 25),
	(27, 29),
	(27, 36),
    (27, 45),
	-- 28
	(28, 17),
	(28, 33),
	(28, 37),
	(28, 5),
	-- 29
	(29, 31),
	(29, 6),
	(29, 1),
	(29, 5),
	(29, 39),
	(29, 11),
	(29, 12),
	(29, 41),
    (29, 60),
    (29, 61),
	-- 30
	(30,18 ),
	(30,32 ),
	(30,43 ),
	(30,31 ),
	(30, 33),
	(30, 5),
	(30,44 ),
	(30, 4),
	(30, 12),
	-- 31
	(31,17 ),
	(31,46 ),
	(31,38 ),
	(31,47 ),
	(31,48 ),
	(31,4 ),
	(31,49 ),
	(31,50 ),
	(31,51 ),
	(31,5 ),
	(31,44 ),
	-- 32 
	(32,52 ),
	(32,44 ),
	(32, 51),
	(32, 53),
	(32, 54),
	(32, 55),
	-- 33 
	(33, 34),
	(33, 12),
	(33, 17),
	(33, 33),
	(33, 4),
	(33, 57),
	-- 34
	(34, 17),
	(34, 12),
	(34, 38),
	(34, 58),
	(34, 4),
	(34, 48),
	-- 35
	(35, 1),
	(35, 13),
	(35, 23),
	(35, 47),
	(35, 51),
	(35, 6),
	(35, 38),
	-- 36
	(36, 63),
	(36, 64),
	(36, 65),
	(36, 16),
	-- 37
	(37, 33),
	(37, 65),
	(37, 4),
	(37, 25),
	(37, 17),
    (37, 66);
	
-- thêm luật 
INSERT INTO Luat (ma_luat, ten_luat,loai_luat)
VALUES
	(1,N'Luật 1',1),
	(2,N'Luật 2',1),
    (3,N'Luật 3',1),
	(4,N'Luật 4',1),
	(5,N'Luật 5',1),
    (6,N'Luật 6',1),
    (7,N'Luật 7',1),
	(8,N'Luật 8',1),
    (9,N'Luật 9',1),
    (10,N'Luật 10',1),
    (11,N'Luật 11',1),
	(12,N'Luật 12',1),
    (13,N'Luật 13',1),
	(14,N'Luật 14',1),
	(15,N'Luật 15',1),
    (16,N'Luật 16',1),
    (17,N'Luật 17',1),
	(18,N'Luật 18',1),
    (19,N'Luật 19',1),
    (20,N'Luật 20',1),
    (21,N'Luật 21',1),
	(22,N'Luật 22',1),
    (23,N'Luật 23',1),
	(24,N'Luật 24',1),
	(25,N'Luật 25',1),
    (26,N'Luật 26',1),
    (27,N'Luật 27',1),
	(28,N'Luật 28',1),
    (29,N'Luật 29',1),
    (30,N'Luật 30',1),
    (31,N'Luật 31',1),
    (32,N'Luật 32',1),
    (33,N'Luật 33',1),
    (34,N'Luật 34',1),
    (35,N'Luật 35',1),
    (36,N'Luật 36',1),
    (37,N'Luật 37',1),
    -- luật loại 2
    (38,N'Luật 38',2),
	(39,N'Luật 39',2),
    (40,N'Luật 40',2),
	(41,N'Luật 41',2),
	(42,N'Luật 42',2),
    (43,N'Luật 43',2),
    (44,N'Luật 44',2),
	(45,N'Luật 45',2),
    (46,N'Luật 46',2),
    (47,N'Luật 47',2),
    (48,N'Luật 48',2),
	(49,N'Luật 49',2),
    (50,N'Luật 50',2),
	(51,N'Luật 51',2),
	(52,N'Luật 52',2),
    (53,N'Luật 53',2),
    (54,N'Luật 54',2),
	(55,N'Luật 55',2),
    (56,N'Luật 56',2),
    (57,N'Luật 57',2),
    (58,N'Luật 58',2),
	(59,N'Luật 59',2),
    (60,N'Luật 60',2),
	(61,N'Luật 61',2),
	(62,N'Luật 62',2),
    (63,N'Luật 63',2),
    (64,N'Luật 64',2),
	(65,N'Luật 65',2),
    (66,N'Luật 66',2),
    (67,N'Luật 67',2),
    (68,N'Luật 68',2),
    (69,N'Luật 69',2),
    (70,N'Luật 70',2),
    (71,N'Luật 71',2),
    (72,N'Luật 72',2),
    (73,N'Luật 73',2),
    (74,N'Luật 74',2),
    (75,N'Luật 75',2),
	(76,N'Luật 76',2),
    (77,N'Luật 77',2),
	(78,N'Luật 78',2),
	(79,N'Luật 79',2),
    (80,N'Luật 80',2),
    (81,N'Luật 81',2),
	(82,N'Luật 82',2),
    (83,N'Luật 83',2),
    (84,N'Luật 84',2),
    (85,N'Luật 85',2),
	(86,N'Luật 86',2),
    (87,N'Luật 87',2),
	(88,N'Luật 88',2),
	(89,N'Luật 89',2),
    (90,N'Luật 90',2),
    (91,N'Luật 91',2),
    (92,N'Luật 92',2),
    (93,N'Luật 93',2),
    (94,N'Luật 94',2),
	(95,N'Luật 95',2),
    (96,N'Luật 96',2),
	(97,N'Luật 97',2),
	(98,N'Luật 98',2),
    (99,N'Luật 99',2),
    (100,N'Luật 100',2),
	(101,N'Luật 101',2),
    (102,N'Luật 102',2),
    (103,N'Luật 103',2),
    (104,N'Luật 104',2),
    (105,N'Luật 105',2),
    (106,N'Luật 106',2),
    (107,N'Luật 107',2),
    (108,N'Luật 108',2),
     -- luật LOẠI 3
	(109,N'Luật 109',3),
	(110,N'Luật 110',3),
   (111,N'Luật 111',3),
    (112,N'Luật 112',3),
    (113,N'Luật 113',3),
    (114,N'Luật 114',3),
    (115,N'Luật 115',3),
    (116,N'Luật 116',3),
    (117,N'Luật 117',3),
    (118,N'Luật 118',3),
	(119,N'Luật 119',3),
    (120,N'Luật 120',3),
    (121,N'Luật 121',3),
    (122,N'Luật 122',3),
    (123,N'Luật 123',3),
    (124,N'Luật 124',3),
    (125,N'Luật 125',3),
    (126,N'Luật 126',3),
    (127,N'Luật 127',3),
	(128,N'Luật 128',3),
    (129,N'Luật 129',3);
	

-- Thêm bệnh luật 
INSERT INTO lien_ket_benh_luat (ma_luat, ma_benh)
VALUES
	(1,1),
	(2,2),
    (3,3),
	(4,4),
	(5,5),
    (6,6),
    (7,1),
	(8,8),
    (9,9),
    (10,10),
    (11,11),
	(12,12),
    (13,13),
	(14,14),
	(15,15),
    (16,16),
    (17,17),
	(18,18),
    (19,19),
    (20,20),
    (21,21),
	(22,22),
    (23,23),
	(24,24),
	(25,25),
    (26,26),
    (27,27),
	(28,28),
    (29,29),
    (30,30),
    (31,31),
    (32,32),
    (33,33),
    (34,34),
    (35,35),
    (36,36),
    (37,37),
    -- luật 2
	(38,2),
    (39,4),
	(39,6),
	(40,6),
    (40,7),
    (41,4),
	(41,13),
    (42,6),
    (42,15),
    (43,13),
	(43,16),
    (44,4),
	(44,17),
	(45,7),
    (45,21),
    (46,21),
	(46,22),
    (47,22),
    (47,23),
    (48,4),
	(48,29),
    (49,6),
	(49,29),
	(50,16),
    (50,29),
    (51,21),
	(51,29),
    (52,21),
    (52,30),
    (53,26),
    (53,30),
    (54,29),
    (54,30),
    (55,30),
    (55,31),
    (56,26),
    (56,33),
	(57,33),
    (57,30),
	(58,31),
	(58,34),
    (59,33),
    (59,34),
	(60,31),
    (60,35),
    (61,33),
    (61,37),
	(62,1),
    (62,4),
	(63,1),
	(63,5),
    (64,1),
    (64,7),
    (65,4),
    (65,7),
    (66,5),
	(66,7),
    (67,7),
	(67,8),
	(67,27),
    (68,6),
    (68,13),
	(68,15),
    (68,16),
    (69,4),
    (69,13),
    (69,14),
    (69,16),
    (69,17),
    (70,30),
    (70,37),
    -- 
    (71,4),
    (71,15),
    (72,7),
    (72,15),
    (72,29),
    (73,24),
    (73,37),
    (73,27),
    (74,1),
    (74,16),
    (74,29),
    (75,29),
    (75,35),
    (76,22),
    (76,35),
    (77,21),
    (77,35),
    (78,30),
    (78,34),
    (79,31),
    (79,33),
    (79,34),
    (79,37),
    (80,28),
    (80,37),
    (80,33),
    (81,14),
    (81,33),
    (82,23),
    (82,26),
    (83,4),
    (83,6),
    (83,21),
    (84,31),
    (84,32),
    (85,22),
    (85,4),
    (85,6),
    (85,28),
    (85,31),
    (85,27),
    (86,28),
    (86,30),
	(87,14),
    (87,22),
    (97,24),
    (88,4),
     (88,6),
    (88,23),
    (88,27),
    (89,13),
    (89,29),
    (90,21),
    (90,22),
    (90,23),
    (90,30),
    (91,1),
    (91,24),
	(92,20),
    (92,30),
    (92,31),
    (93,16),
    (93,24),
    (93,25),
    (93,33),
    (93,34),
    (94,25),
    (94,29),
    (94,30),
    (95,1),
    (95,25),
    (96,20),
    (96,29),
    (96,27),
    (97,21),
    (97,25),
    (98,22),
    (98,25),
	(99,21),
    (99,26),
    (100,1),
    (100,26),
	(101,4),
    (101,6),
	(101,27),
    (102,2),
    (102,27),
    (103,5),
    (103,27),
    (104,21),
    (105,27),
    (105,22),
    (106,25),
    (106,27),
    (107,26),
    (107,27),
    (108,35),
    (108,27),
    -- luật 3
    (109,1),
    (110,2),
    (111,5),
    (112,7),
    (113,8),
    (14,9),
    (115,11),
    (16,12),
    (17,13),
    (118,15),
    (119,18),
    (120,22),
    (121,24),
    (122,26),
    (123,28),
    (124,29),
    (125,30),
    (126,31),
    (127,32),
    (128,34),
    (129,36);
INSERT INTO lien_ket_trieu_chung_luat (ma_luat,ma_trieu_chung)
VALUES
	-- luật 1
	(1, 30),
    (1, 11),
	(1, 3),
	(1, 90),
	(1, 91),
	(1, 56),
	(1, 92),
	(1, 7),
	(1, 12),
	(1, 36),
	(1, 26),
	-- --2
    (2, 30),
    (2, 36),
	(2, 62),
	(2, 26),
	(2, 93),
	(2, 45),
	(2, 67),
	(2, 68),
	-- 3 
	(3, 69),
	(3, 70),
	(3, 71),
	(3, 72),
	-- 4
	(4, 24),
	(4, 17),
	(4, 73),
	(4, 20),
	(4, 74),
	(4, 90),
	(4, 6),
	(4, 5),
	(4, 39),
	(4, 91),
	(4, 76),
	-- 5 
	(5, 11),
	(5, 9),
	(5, 29),
	(5, 36),
	(5, 78),
	(5, 79),
	-- 6 
	(6, 24),
	(6, 17),
	(6, 73),
	(6, 20),
	(6, 74),
	(6, 11),
	(6, 6),
	(6, 5),
	-- 7 
	(7, 9),
	(7, 20),
	(7, 94),
	(7, 11),
	(7, 14),
	(7, 6),
	(7, 30),
	(7, 95),
	(7, 96),
	(7, 97),
	-- 8
	(8, 9),
	(8, 20),
	(8, 81),
	(8, 80),
	-- 9
	(9, 82),
	(9, 92),
	(9, 9),
	-- 10
	(10, 84),
	(10, 9),
	(10, 83),

	-- 11
	(11, 17),
	(11, 85),
	(11, 81),
	-- 12
	(12, 82),
	(12, 97),
	(12, 98),
	(12, 87),
	(12, 88),
	(12, 89),
	-- 13
	(13, 75),
	(13, 11),
	(13, 76),
	(13, 17),
	(13, 39),
	-- 14
	(14, 19),
	(14, 39),
	(14, 17),
	(14, 57),
	-- 15
	(15, 11),
	(15, 6),
	(15, 17),
	(15, 77),
	-- 16
	(16, 39),
	(16, 12),
	(16, 11),
	(16, 17),
	-- 17
	(17, 39),
	(17, 90),
	(17, 17),
	(18, 1),
	(18, 2),
	(18, 3),
    (18, 59),
	(20, 1),
	(20, 4),
	(20, 5),
	(21, 6),
	(21, 18),
	(21, 8),
	(21,9),
	(21, 5),
	(21, 12),
	(21, 13),
	(21, 14),
	(22, 19),
	(22, 15),
	(22, 5),
	(22, 17),
	(22, 18),
	(23, 19),
	(23, 18),
	(23, 20),
	(23, 5),
	(22, 21),
	(22, 22),
	(22, 23),
	(22, 13),
	(24, 17),
	(24, 25),
	(24, 19),
	(24, 26),
	(24, 27),
	(24, 12),
	(24, 28),
	(25, 29),
	(25, 30),
	(25, 13),
	(25, 17),
	(25, 31),
	(25, 12),
	(26, 18),
	(26, 32),
	(26,40),
	(26, 33),
	(26, 20),
	(26, 34),
	(26, 36),
	(26, 35),
	(26, 12),
    (27, 1),
	(27, 5),
	(27, 9),
	(27, 13),
	(27, 17),
	(27, 20),
	(27, 25),
	(27, 29),
	(27, 36),
    (27, 45),
	(28, 17),
	(28, 33),
	(28, 37),
	(28, 5),
	(29, 31),
	(29, 6),
	(29, 1),
	(29, 5),
	(29, 39),
	(29, 11),
	(29, 12),
	(29, 41),
    (29, 60),
    (29, 61),
	(30,18 ),
	(30,32 ),
	(30,43 ),
	(30,31 ),
	(30, 33),
	(30, 5),
	(30,44 ),
	(30, 4),
	(30, 12),
	(31,17 ),
	(31,46 ),
	(31,38 ),
	(31,47 ),
	(31,48 ),
	(31,4 ),
	(31,49 ),
	(31,50 ),
	(31,51 ),
	(31,5 ),
	(31,44 ),
	(32,52 ),
	(32,44 ),
	(32, 51),
	(32, 53),
	(32, 54),
	(32, 55),
	(33, 34),
	(33, 12),
	(33, 17),
	(33, 33),
	(33, 4),
	(33, 57),
	(34, 17),
	(34, 12),
	(34, 38),
	(34, 58),
	(34, 4),
	(34, 48),
	(35, 1),
	(35, 13),
	(35, 23),
	(35, 47),
	(35, 51),
	(35, 6),
	(35, 38),
	(36, 63),
	(36, 64),
	(36, 65),
	(36, 16),
	(37, 33),
	(37, 65),
	(37, 4),
	(37, 25),
	(37, 17),
    (37, 66),
    -- LUẬT LOẠI 2
    (38, 30),
    (38, 36),
    (38, 26),
	(39, 5),
    (39, 6),
    (39, 24),
	(39, 17),
    (39, 73),
    (39, 20),
    (39, 74),
    (40, 6),
    (40, 11),
    (40, 20),
    (41, 39),
    (41, 76),
    (41, 17),
    (42, 11),
    (42, 6),
    (42, 17),
    (43, 11),
    (43, 39),
    (43, 17),
    (44, 90),
    (44, 39),
    (44, 17),
    (45, 6),
    (45, 9),
    (45, 14),
    (46, 5),
    (46, 18),
    (46, 13),
    (47, 5),
    (47, 18),
    (47, 19),
    (48, 5),
    (48, 6),
    (48, 39),
    (49, 5),
    (49, 6),
    (49, 11),
    (50, 12),
    (50, 39),
    (50, 11),
    (51, 12),
    (51, 5),
    (51, 6),
    (52, 12),
    (52, 5),
    (52, 18),
    (53, 12),
    (53, 32),
    (53, 33),
    (53, 18),
	(54, 5),
    (54, 31),
    (54, 12),
    (55, 4),
    (55, 44),
    (55, 5),
    (56, 33),
    (56, 34),
    (56, 12),
    (57, 12),
    (57, 33),
    (57, 4),
    (58, 4),
    (58, 17),
    (58, 48),
    (58, 38),
    (59, 17),
    (59, 12),
    (59, 4),
    (60, 38),
    (60, 51),
    (60, 47),
	(61, 17),
    (61, 33),
    (61, 4),
	(62,90 ),
    (62, 91),
    (63,11 ),
    (63, 36),
    (64,11 ),
    (64, 30),
    (65,20 ),
    (65, 6),
    (66,9 ),
    (66, 11),
    (67,20 ),
    (67, 9),
    (68,11 ),
    (68, 17),
    (69,17 ),
    (69, 39),
    (70,33),
    (70,4),
    (71,6),
    (71,17),
    (72,6),
    (72,11),
    (73,17),
    (73,25),
    (74,11),
    (74,12),
    (75,1),
    (75,6),
    (76,13),
    (76,23),
    (77,6),
    (77,13),
    (78,4),
    (78,12),
    (79,17),
    (79,4),
    (80,33),
    (80,17),
    (81,57),
    (81,17),
    (82,18),
    (82,20),
    (83,5),
    (83,6),
    (84,44),
    (84,51),
    (85,5),
    (85,17),
    (86,33),
    (86,5),
    (87,19),
    (87,17),
    (88,5),
    (88,20),
    (89,11),
    (89,39),
    (90,5),
    (90,18),
    (91,12),
    (91,26),
    (92,4),
    (92,5),
    (93,12),
    (93,17),
    (94,12),
    (94,31),
    (95,12),
    (95,30),
    (96,5),
    (96,1),
    (97,12),
    (97,13),
    (98,13),
    (98,17),
    (99,12),
    (99,18),
    (100,12),
    (100,36),
    (101,15),
    (101,17),
    (101,20),
    (102,36),
    (102,45),
    (103,9),
    (103,29),
    (103,36),
	(104,9),
    (104,5),
    (104,13),
	(105,5),
    (105,13),
    (105,17),
    (106,29),
    (106,13),
    (106,17),
    (107,20),
    (107,36),
    (108,1),
    (108,13),
    (109,56),
    (109,7),
    (110,45),
    (110,62),
    (110,67),
    (110,68),
    (110,93),
    (111,79),
	(111,78),
	(112,94),
	(112,95),
    (112,96),
    (113,80),
    (114,83),
    (114,84),
    (115,85),
    (116,87),
	(116,88),
	(116,89),
	(116,98),
    (117,75),
    (118,77),
    (119,2),
    (120,15),
    (120,21),
    (120,22),
    (121,27),
    (121,28),
    (122,35),
    (122,40),
    (123,37),
    (124,40),
	(124,60),
	(124,61),
    (125,43),
    (126,46),
	(126,49),
    (126,50),
	(127,52),
    (127,53),
	(127,54),
    (127,55),
    (128,58),
    (129,16),
    (129,63),
    (129,64);
    
	
-- xóa các bảng
Drop table  Benh;
Drop table TrieuChung;
Drop table  TrieuChung_Benh;
drop table Benh;
DELETE FROM benh;
-----------
select * from benh;
select * from trieuchung;
select * from TrieuChung_Benh;
select * from luat;

-- -- -- -- -- -- -- 

--  những bệnh cùng chung triệu chứng
SELECT A.MaBenh AS Benh1, B.MaBenh AS Benh2, GROUP_CONCAT(T.MaTrieuChung ORDER BY T.MaTrieuChung ASC SEPARATOR ', ') AS ChiaSeTrieuChung
FROM TrieuChung_Benh A
INNER JOIN TrieuChung_Benh B ON A.MaTrieuChung = B.MaTrieuChung AND A.MaBenh < B.MaBenh
INNER JOIN TrieuChung T ON A.MaTrieuChung = T.MaTrieuChung
GROUP BY A.MaBenh, B.MaBenh
HAVING COUNT(T.MaTrieuChung) >= 2;
-- 
-- triệu chứng khác biệt giữa các căn bệnh
SELECT B.MaBenh,B.TenBenh ,TT.TenTrieuChung AS TrieuChungKhacBiet
FROM Benh B
CROSS JOIN (
    SELECT T.TenTrieuChung
    FROM TrieuChung T
    LEFT JOIN TrieuChung_Benh BT ON T.MaTrieuChung = BT.MaTrieuChung
    GROUP BY T.TenTrieuChung
    HAVING COUNT(DISTINCT BT.MaBenh) = 1
) AS TT
LEFT JOIN TrieuChung_Benh BT ON B.MaBenh = BT.MaBenh
LEFT JOIN TrieuChung T ON BT.MaTrieuChung = T.MaTrieuChung
WHERE T.TenTrieuChung = TT.TenTrieuChung;

-- hiển thị bệnh và triệu trứng của nó 
SELECT Benh.MaBenh, Benh.TenBenh, TrieuChung_Benh.MaTrieuChung , TrieuChung.TenTrieuChung
FROM Benh
INNER JOIN TrieuChung_Benh ON Benh.MaBenh = TrieuChung_Benh.MaBenh
INNER JOIN TrieuChung ON TrieuChung_Benh.MaTrieuChung = TrieuChung.MaTrieuChung;
--
-- hiển thị các triệu trứng và số lần xuất hiện của nó ở tất cả các bệnh
SELECT TC.MaTrieuChung, TC.TenTrieuChung, COUNT(*) AS SoLanXuatHien
FROM TrieuChung_Benh TB
JOIN TrieuChung TC ON TB.MaTrieuChung = TC.MaTrieuChung
GROUP BY TC.MaTrieuChung, TC.TenTrieuChung
ORDER BY SoLanXuatHien DESC;
-- hiển thị luật 
SELECT 
    L.MaLuat,
    GROUP_CONCAT(DISTINCT LTCL.MaTrieuChung SEPARATOR '+') AS MaTrieuChung,
    GROUP_CONCAT(DISTINCT LBL.MaBenh SEPARATOR '+') AS MaBenh
FROM 
    Luat L
JOIN 
    LienKet_TrieuChung_Luat LTCL ON L.MaLuat = LTCL.MaLuat
JOIN 
    LienKet_Benh_Luat LBL ON L.MaLuat = LBL.MaLuat
GROUP BY 
    L.MaLuat;
    
-- tìm mã bệnh khi đã có luật 
SELECT LTCL.MaLuat, LBL.MaBenh
FROM LienKet_TrieuChung_Luat LTCL
JOIN LienKet_Benh_Luat LBL ON LTCL.MaLuat = LBL.MaLuat
WHERE LTCL.MaTrieuChung IN (5,13,18) -- Thay thế các mã triệu chứng cần tìm ở đây
GROUP BY LTCL.MaLuat, LBL.MaBenh
HAVING COUNT(DISTINCT LTCL.MaTrieuChung) = 3;
-- 
SELECT TC.ma_trieu_chung, TC.ten_trieu_chung, COUNT(TCB.ma_benh) AS so_lan_xuat_hien
FROM trieu_chung TC
LEFT JOIN trieu_chung_benh TCB ON TC.ma_trieu_chung = TCB.ma_trieu_chung
GROUP BY TC.ma_trieu_chung, TC.ten_trieu_chung
HAVING COUNT(TCB.ma_benh) > 6;

-- 
SELECT Luat.ma_luat, Luat.ten_luat, Benh.ten_benh, trieu_chung.ma_trieu_chung
FROM Luat
JOIN lien_ket_benh_luat ON Luat.ma_luat = lien_ket_benh_luat.ma_luat
JOIN Benh ON lien_ket_benh_luat.ma_benh = Benh.ma_benh
JOIN lien_ket_trieu_chung_luat ON Luat.ma_luat = lien_ket_trieu_chung_luat.ma_luat
JOIN trieu_chung ON lien_ket_trieu_chung_luat.ma_trieu_chung = trieu_chung.ma_trieu_chung;


-- 
SELECT DISTINCT b.ma_benh, b.ten_benh
FROM benh b
JOIN trieu_chung_benh tb ON b.ma_benh = tb.ma_benh
JOIN trieu_chung tc ON tb.ma_trieu_chung = tc.ma_trieu_chung
WHERE tc.ma_trieu_chung IN (7, 13, 18, 21, 28, 63, 15, 22, 20);
-- 
SELECT DISTINCT B.ma_benh, B.ten_benh
FROM trieu_chung_benh AS TC
INNER JOIN benh AS B ON TC.ma_benh = B.ma_benh
INNER JOIN trieu_chung AS T ON TC.ma_trieu_chung = T.ma_trieu_chung
WHERE T.ma_trieu_chung IN (11,12,25);
